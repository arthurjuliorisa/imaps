generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model activity_logs {
  id          String   @id @default(dbgenerated("(gen_random_uuid())::text"))
  user_id     String?
  action      String   @db.VarChar(100)
  description String
  ip_address  String?  @db.VarChar(45)
  user_agent  String?
  status      String
  created_at  DateTime @default(now()) @db.Timestamp(6)
  users       users?   @relation(fields: [user_id], references: [id], onUpdate: NoAction)

  @@index([created_at(sort: Desc)], map: "idx_activity_logs_created_at")
  @@index([status], map: "idx_activity_logs_status")
  @@index([user_id], map: "idx_activity_logs_user_id")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model adjustment_details {
  id              BigInt          @default(autoincrement())
  header_id       BigInt
  wms_id          String          @db.VarChar(100)
  company_code    String          @db.VarChar(50)
  trx_date        DateTime        @db.Date
  adjustment_type adjustment_type
  item_type_code  String          @db.VarChar(10)
  item_code       String          @db.VarChar(50)
  item_name       String          @db.VarChar(200)
  uom             String          @db.VarChar(20)
  qty             Decimal         @db.Decimal(15, 3)
  reason          String?         @db.VarChar(500)
  created_at      DateTime        @default(now()) @db.Timestamp(6)
  updated_at      DateTime        @default(now()) @db.Timestamp(6)
  companies       companies       @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)
  item_types      item_types      @relation(fields: [item_type_code], references: [item_type_code], onDelete: NoAction, onUpdate: NoAction)
  adjustments     adjustments     @relation(fields: [header_id, trx_date], references: [id, trx_date], onDelete: Cascade, onUpdate: NoAction, map: "fk_adjustment_details_header")

  @@id([id, trx_date])
  @@index([header_id, trx_date], map: "idx_adjustment_details_header")
  @@index([company_code, item_code, trx_date(sort: Desc)], map: "idx_adjustment_details_item")
  @@index([company_code, item_type_code, trx_date(sort: Desc)], map: "idx_adjustment_details_item_type")
  @@index([company_code, item_code, item_type_code, trx_date(sort: Desc), adjustment_type, qty], map: "idx_adjustment_details_stock_calc")
  @@index([adjustment_type, company_code], map: "idx_adjustment_details_type")
  @@index([wms_id, company_code], map: "idx_adjustment_details_wms_id")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model adjustments {
  id                       BigInt               @default(autoincrement())
  wms_id                   String               @db.VarChar(100)
  company_code             String               @db.VarChar(50)
  wms_doc_type             String?              @db.VarChar(100)
  internal_evidence_number String               @db.VarChar(50)
  trx_date                 DateTime             @db.Date
  wms_timestamp            DateTime             @db.Timestamptz(6)
  received_at              DateTime             @default(now()) @db.Timestamptz(6)
  created_at               DateTime             @default(now()) @db.Timestamp(6)
  updated_at               DateTime             @default(now()) @db.Timestamp(6)
  adjustment_details       adjustment_details[]
  companies                companies            @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, trx_date])
  @@unique([wms_id, trx_date], map: "uk_adjustments_wms_id")
  @@index([company_code, trx_date(sort: Desc)], map: "idx_adjustments_company")
  @@index([wms_id], map: "idx_adjustments_wms_id")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model batch_processing_logs {
  id                 String    @id @default(dbgenerated("(gen_random_uuid())::text"))
  job_type           String
  status             String
  started_at         DateTime  @default(now()) @db.Timestamp(6)
  completed_at       DateTime? @db.Timestamp(6)
  total_records      Int?
  successful_records Int?
  failed_records     Int?
  error_message      String?
  created_at         DateTime  @default(now()) @db.Timestamp(6)
  updated_at         DateTime  @default(now()) @db.Timestamp(6)

  @@index([job_type], map: "idx_batch_logs_job_type")
  @@index([started_at(sort: Desc)], map: "idx_batch_logs_started_at")
  @@index([status], map: "idx_batch_logs_status")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model beginning_balances {
  id             BigInt     @id @default(autoincrement())
  company_code   String     @db.VarChar(50)
  item_type_code String     @db.VarChar(10)
  item_code      String     @db.VarChar(50)
  item_name      String     @db.VarChar(200)
  uom            String     @db.VarChar(20)
  balance_qty    Decimal    @default(0) @db.Decimal(15, 3)
  balance_date   DateTime   @db.Date
  created_at     DateTime   @default(now()) @db.Timestamp(6)
  updated_at     DateTime   @default(now()) @db.Timestamp(6)
  companies      companies  @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)
  item_types     item_types @relation(fields: [item_type_code], references: [item_type_code], onDelete: NoAction, onUpdate: NoAction)

  @@unique([company_code, item_code, balance_date], map: "uk_beginning_balances_item")
  @@index([company_code, balance_date(sort: Desc)], map: "idx_beginning_balances_company")
  @@index([company_code, item_code], map: "idx_beginning_balances_item")
  @@index([item_type_code], map: "idx_beginning_balances_item_type")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model companies {
  company_code                                              String                                @id @db.VarChar(50)
  company_name                                              String                                @unique @db.VarChar(200)
  is_active                                                 Boolean                               @default(true)
  created_at                                                DateTime                              @default(now()) @db.Timestamp(6)
  updated_at                                                DateTime                              @default(now()) @db.Timestamp(6)
  adjustment_details                                        adjustment_details[]
  adjustments                                               adjustments[]
  beginning_balances                                        beginning_balances[]
  finished_goods_production_details                         finished_goods_production_details[]
  finished_goods_production_headers                         finished_goods_production_headers[]
  incoming_details                                          incoming_details[]
  incoming_headers_incoming_headers_company_codeTocompanies incoming_headers[]                    @relation("incoming_headers_company_codeTocompanies")
  incoming_headers_incoming_headers_ownerTocompanies        incoming_headers[]                    @relation("incoming_headers_ownerTocompanies")
  material_usage_details                                    material_usage_details[]
  material_usage_headers                                    material_usage_headers[]
  outgoing_details                                          outgoing_details[]
  outgoing_fg_production_traceability                       outgoing_fg_production_traceability[]
  outgoing_headers_outgoing_headers_company_codeTocompanies outgoing_headers[]                    @relation("outgoing_headers_company_codeTocompanies")
  outgoing_headers_outgoing_headers_ownerTocompanies        outgoing_headers[]                    @relation("outgoing_headers_ownerTocompanies")
  snapshot_recalc_queue                                     snapshot_recalc_queue[]
  stock_daily_snapshot                                      stock_daily_snapshot[]
  users                                                     users[]
  wip_balance                                               wip_balance[]
  work_order_fg_production                                  work_order_fg_production[]
  work_order_material_consumption                           work_order_material_consumption[]

  @@index([is_active], map: "idx_companies_active")
  @@index([company_name], map: "idx_companies_name")
}

/// Master data model for Currency
/// Maps to "Currency" table in database (PascalCase from initial migration)
model currency {
  id        String   @id
  code      String   @unique
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("Currency")
}

/// Master data model for Unit of Measure (UOM)
/// Maps to "UOM" table in database (PascalCase from initial migration)
model uOM {
  id        String   @id
  code      String   @unique
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("UOM")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model finished_goods_production_details {
  id                                BigInt                            @default(autoincrement())
  header_id                         BigInt
  wms_id                            String                            @db.VarChar(100)
  company_code                      String                            @db.VarChar(50)
  trx_date                          DateTime                          @db.Date
  item_type_code                    String                            @db.VarChar(10)
  item_code                         String                            @db.VarChar(50)
  item_name                         String                            @db.VarChar(200)
  uom                               String                            @db.VarChar(20)
  qty                               Decimal                           @db.Decimal(15, 3)
  work_order_numbers                String[]
  created_at                        DateTime                          @default(now()) @db.Timestamp(6)
  updated_at                        DateTime                          @default(now()) @db.Timestamp(6)
  companies                         companies                         @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)
  item_types                        item_types                        @relation(fields: [item_type_code], references: [item_type_code], onDelete: NoAction, onUpdate: NoAction)
  finished_goods_production_headers finished_goods_production_headers @relation(fields: [header_id, trx_date], references: [id, trx_date], onDelete: Cascade, onUpdate: NoAction, map: "fk_finished_goods_production_details_header")

  @@id([id, trx_date])
  @@index([header_id, trx_date], map: "idx_finished_goods_production_details_header")
  @@index([company_code, item_code, trx_date(sort: Desc)], map: "idx_finished_goods_production_details_item")
  @@index([item_code, trx_date(sort: Desc)], map: "idx_finished_goods_production_details_item_date")
  @@index([item_name(ops: raw("gin_trgm_ops"))], map: "idx_finished_goods_production_details_item_name_trgm", type: Gin)
  @@index([company_code, item_type_code, trx_date(sort: Desc)], map: "idx_finished_goods_production_details_item_type")
  @@index([company_code, item_code, item_type_code, trx_date(sort: Desc), qty], map: "idx_finished_goods_production_details_stock_calc")
  @@index([wms_id, company_code], map: "idx_finished_goods_production_details_wms_id")
  @@index([work_order_numbers], map: "idx_finished_goods_production_details_wo", type: Gin)
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model finished_goods_production_headers {
  id                                BigInt                              @default(autoincrement())
  wms_id                            String                              @db.VarChar(100)
  company_code                      String                              @db.VarChar(50)
  internal_evidence_number          String                              @db.VarChar(50)
  reversal                          String?                             @db.VarChar(1)
  trx_date                          DateTime                            @db.Date
  wms_timestamp                     DateTime                            @db.Timestamptz(6)
  received_at                       DateTime                            @default(now()) @db.Timestamptz(6)
  created_at                        DateTime                            @default(now()) @db.Timestamp(6)
  updated_at                        DateTime                            @default(now()) @db.Timestamp(6)
  finished_goods_production_details finished_goods_production_details[]
  companies                         companies                           @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, trx_date])
  @@unique([wms_id, trx_date], map: "uk_finished_goods_production_headers_wms_id")
  @@index([company_code, trx_date(sort: Desc)], map: "idx_finished_goods_production_headers_company")
  @@index([wms_id], map: "idx_finished_goods_production_headers_wms_id")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model incoming_details {
  id               BigInt           @default(autoincrement())
  header_id        BigInt
  wms_id           String           @db.VarChar(100)
  company_code     String           @db.VarChar(50)
  trx_date         DateTime         @db.Date
  item_type_code   String           @db.VarChar(10)
  item_code        String           @db.VarChar(50)
  item_name        String           @db.VarChar(200)
  hs_code          String?          @db.VarChar(20)
  uom              String           @db.VarChar(20)
  qty              Decimal          @db.Decimal(15, 3)
  currency         currency_code
  amount           Decimal          @db.Decimal(15, 4)
  created_at       DateTime         @default(now()) @db.Timestamp(6)
  updated_at       DateTime         @default(now()) @db.Timestamp(6)
  incoming_headers incoming_headers @relation(fields: [header_id, trx_date], references: [id, trx_date], onDelete: Cascade, onUpdate: NoAction, map: "fk_incoming_details_header")
  companies        companies        @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)
  item_types       item_types       @relation(fields: [item_type_code], references: [item_type_code], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, trx_date])
  @@index([header_id, trx_date], map: "idx_incoming_details_header")
  @@index([company_code, item_code, trx_date(sort: Desc)], map: "idx_incoming_details_item")
  @@index([item_name(ops: raw("gin_trgm_ops"))], map: "idx_incoming_details_item_name_trgm", type: Gin)
  @@index([company_code, item_type_code, trx_date(sort: Desc)], map: "idx_incoming_details_item_type")
  @@index([company_code, item_code, item_type_code, trx_date(sort: Desc), qty, currency, amount], map: "idx_incoming_details_stock_calc")
  @@index([wms_id, company_code], map: "idx_incoming_details_wms_id")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model incoming_headers {
  id                                                 BigInt                         @default(autoincrement())
  wms_id                                             String                         @db.VarChar(100)
  company_code                                       String                         @db.VarChar(50)
  owner                                              String                         @db.VarChar(50)
  customs_document_type                              customs_document_type_incoming
  ppkek_number                                       String                         @db.VarChar(50)
  customs_registration_date                          DateTime                       @db.Date
  incoming_evidence_number                           String                         @db.VarChar(50)
  incoming_date                                      DateTime                       @db.Date
  invoice_number                                     String                         @db.VarChar(50)
  invoice_date                                       DateTime                       @db.Date
  shipper_name                                       String                         @db.VarChar(200)
  trx_date                                           DateTime                       @db.Date
  wms_timestamp                                      DateTime                       @db.Timestamptz(6)
  received_at                                        DateTime                       @default(now()) @db.Timestamptz(6)
  created_at                                         DateTime                       @default(now()) @db.Timestamp(6)
  updated_at                                         DateTime                       @default(now()) @db.Timestamp(6)
  incoming_details                                   incoming_details[]
  companies_incoming_headers_company_codeTocompanies companies                      @relation("incoming_headers_company_codeTocompanies", fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)
  companies_incoming_headers_ownerTocompanies        companies                      @relation("incoming_headers_ownerTocompanies", fields: [owner], references: [company_code], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, trx_date])
  @@unique([wms_id, trx_date], map: "uk_incoming_headers_wms_id")
  @@index([company_code, trx_date(sort: Desc)], map: "idx_incoming_headers_company")
  @@index([company_code, incoming_date, customs_registration_date], map: "idx_incoming_headers_company_date_range")
  @@index([customs_document_type, company_code], map: "idx_incoming_headers_customs_doc")
  @@index([incoming_date, company_code], map: "idx_incoming_headers_date")
  @@index([owner, trx_date(sort: Desc)], map: "idx_incoming_headers_owner")
  @@index([ppkek_number, company_code], map: "idx_incoming_headers_ppkek")
  @@index([wms_id], map: "idx_incoming_headers_wms_id")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model item_types {
  item_type_code                    String                              @id @db.VarChar(10)
  item_type_name                    String                              @unique @db.VarChar(100)
  item_type_name_local              String?                             @db.VarChar(100)
  is_active                         Boolean                             @default(true)
  is_inventory_item                 Boolean                             @default(true)
  is_capital_goods                  Boolean                             @default(false)
  created_at                        DateTime                            @default(now()) @db.Timestamp(6)
  updated_at                        DateTime                            @default(now()) @db.Timestamp(6)
  adjustment_details                adjustment_details[]
  beginning_balances                beginning_balances[]
  finished_goods_production_details finished_goods_production_details[]
  incoming_details                  incoming_details[]
  material_usage_details            material_usage_details[]
  outgoing_details                  outgoing_details[]
  stock_daily_snapshot              stock_daily_snapshot[]
  wip_balance                       wip_balance[]
  work_order_fg_production          work_order_fg_production[]

  @@index([is_active], map: "idx_item_types_active")
  @@index([is_capital_goods], map: "idx_item_types_capital")
  @@index([is_inventory_item], map: "idx_item_types_inventory")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model material_usage_details {
  id                     BigInt                 @default(autoincrement())
  header_id              BigInt
  wms_id                 String                 @db.VarChar(100)
  company_code           String                 @db.VarChar(50)
  work_order_number      String?                @db.VarChar(50)
  cost_center_number     String?                @db.VarChar(50)
  trx_date               DateTime               @db.Date
  item_type_code         String                 @db.VarChar(10)
  item_code              String                 @db.VarChar(50)
  item_name              String                 @db.VarChar(200)
  uom                    String                 @db.VarChar(20)
  qty                    Decimal                @db.Decimal(15, 3)
  ppkek_number           String?                @db.VarChar(50)
  created_at             DateTime               @default(now()) @db.Timestamp(6)
  updated_at             DateTime               @default(now()) @db.Timestamp(6)
  material_usage_headers material_usage_headers @relation(fields: [header_id, trx_date], references: [id, trx_date], onDelete: Cascade, onUpdate: NoAction, map: "fk_material_usage_details_header")
  companies              companies              @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)
  item_types             item_types             @relation(fields: [item_type_code], references: [item_type_code], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, trx_date])
  @@index([header_id, trx_date], map: "idx_material_usage_details_header")
  @@index([company_code, item_code, trx_date(sort: Desc)], map: "idx_material_usage_details_item")
  @@index([item_name(ops: raw("gin_trgm_ops"))], map: "idx_material_usage_details_item_name_trgm", type: Gin)
  @@index([company_code, item_code, item_type_code, trx_date(sort: Desc), qty], map: "idx_material_usage_details_stock_calc")
  @@index([wms_id, company_code], map: "idx_material_usage_details_wms_id")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model material_usage_headers {
  id                       BigInt                   @default(autoincrement())
  wms_id                   String                   @db.VarChar(100)
  company_code             String                   @db.VarChar(50)
  work_order_number        String?                  @db.VarChar(50)
  cost_center_number       String?                  @db.VarChar(50)
  internal_evidence_number String                   @db.VarChar(50)
  reversal                 String?                  @db.VarChar(1)
  trx_date                 DateTime                 @db.Date
  wms_timestamp            DateTime                 @db.Timestamptz(6)
  received_at              DateTime                 @default(now()) @db.Timestamptz(6)
  created_at               DateTime                 @default(now()) @db.Timestamp(6)
  updated_at               DateTime                 @default(now()) @db.Timestamp(6)
  material_usage_details   material_usage_details[]
  companies                companies                @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, trx_date])
  @@unique([wms_id, trx_date], map: "uk_material_usage_headers_wms_id")
  @@index([company_code, trx_date(sort: Desc)], map: "idx_material_usage_headers_company")
  @@index([wms_id], map: "idx_material_usage_headers_wms_id")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model menus {
  id                String              @id @default(dbgenerated("(gen_random_uuid())::text"))
  name              String              @unique
  route             String?
  icon              String?
  parent_id         String?
  order             Int                 @default(0)
  created_at        DateTime            @default(now()) @db.Timestamp(6)
  updated_at        DateTime            @default(now()) @db.Timestamp(6)
  menus             menus?              @relation("menusTomenus", fields: [parent_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  other_menus       menus[]             @relation("menusTomenus")
  user_access_menus user_access_menus[]

  @@index([parent_id], map: "idx_menus_parent_id")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model outgoing_details {
  id                                  BigInt                                @default(autoincrement())
  header_id                           BigInt
  wms_id                              String                                @db.VarChar(100)
  company_code                        String                                @db.VarChar(50)
  trx_date                            DateTime                              @db.Date
  item_type_code                      String                                @db.VarChar(10)
  item_code                           String                                @db.VarChar(50)
  item_name                           String                                @db.VarChar(200)
  hs_code                             String?                               @db.VarChar(20)
  uom                                 String                                @db.VarChar(20)
  qty                                 Decimal                               @db.Decimal(15, 3)
  currency                            currency_code
  amount                              Decimal                               @db.Decimal(15, 4)
  created_at                          DateTime                              @default(now()) @db.Timestamp(6)
  updated_at                          DateTime                              @default(now()) @db.Timestamp(6)
  outgoing_headers                    outgoing_headers                      @relation(fields: [header_id, trx_date], references: [id, trx_date], onDelete: Cascade, onUpdate: NoAction, map: "fk_outgoing_details_header")
  companies                           companies                             @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)
  item_types                          item_types                            @relation(fields: [item_type_code], references: [item_type_code], onDelete: NoAction, onUpdate: NoAction)
  outgoing_fg_production_traceability outgoing_fg_production_traceability[]

  @@id([id, trx_date])
  @@index([header_id, trx_date], map: "idx_outgoing_details_header")
  @@index([company_code, item_code, trx_date(sort: Desc)], map: "idx_outgoing_details_item")
  @@index([item_name(ops: raw("gin_trgm_ops"))], map: "idx_outgoing_details_item_name_trgm", type: Gin)
  @@index([company_code, item_type_code, trx_date(sort: Desc)], map: "idx_outgoing_details_item_type")
  @@index([company_code, item_code, item_type_code, trx_date(sort: Desc), qty, currency, amount], map: "idx_outgoing_details_stock_calc")
  @@index([wms_id, company_code], map: "idx_outgoing_details_wms_id")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model outgoing_fg_production_traceability {
  id                 BigInt           @default(autoincrement())
  outgoing_detail_id BigInt
  outgoing_wms_id    String           @db.VarChar(100)
  production_wms_id  String           @db.VarChar(100)
  company_code       String           @db.VarChar(50)
  item_code          String           @db.VarChar(50)
  trx_date           DateTime         @db.Date
  allocated_qty      Decimal?         @db.Decimal(15, 3)
  allocation_notes   String?
  created_at         DateTime         @default(now()) @db.Timestamp(6)
  updated_at         DateTime         @default(now()) @db.Timestamp(6)
  outgoing_details   outgoing_details @relation(fields: [outgoing_detail_id, trx_date], references: [id, trx_date], onDelete: Cascade, onUpdate: NoAction, map: "fk_outgoing_fg_trace_detail")
  companies          companies        @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, trx_date])
  @@index([outgoing_detail_id, trx_date], map: "idx_outgoing_fg_trace_detail")
  @@index([company_code, item_code, trx_date(sort: Desc)], map: "idx_outgoing_fg_trace_item")
  @@index([outgoing_wms_id, company_code], map: "idx_outgoing_fg_trace_outgoing_wms")
  @@index([production_wms_id, company_code, trx_date(sort: Desc)], map: "idx_outgoing_fg_trace_production")
  @@index([production_wms_id, company_code, trx_date(sort: Desc), allocated_qty], map: "idx_outgoing_fg_trace_summary")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model outgoing_headers {
  id                                                 BigInt                         @default(autoincrement())
  wms_id                                             String                         @db.VarChar(100)
  company_code                                       String                         @db.VarChar(50)
  owner                                              String                         @db.VarChar(50)
  customs_document_type                              customs_document_type_outgoing
  ppkek_number                                       String                         @db.VarChar(50)
  customs_registration_date                          DateTime                       @db.Date
  outgoing_evidence_number                           String                         @db.VarChar(50)
  outgoing_date                                      DateTime                       @db.Date
  invoice_number                                     String                         @db.VarChar(50)
  invoice_date                                       DateTime                       @db.Date
  recipient_name                                     String                         @db.VarChar(200)
  trx_date                                           DateTime                       @db.Date
  wms_timestamp                                      DateTime                       @db.Timestamptz(6)
  received_at                                        DateTime                       @default(now()) @db.Timestamptz(6)
  created_at                                         DateTime                       @default(now()) @db.Timestamp(6)
  updated_at                                         DateTime                       @default(now()) @db.Timestamp(6)
  outgoing_details                                   outgoing_details[]
  companies_outgoing_headers_company_codeTocompanies companies                      @relation("outgoing_headers_company_codeTocompanies", fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)
  companies_outgoing_headers_ownerTocompanies        companies                      @relation("outgoing_headers_ownerTocompanies", fields: [owner], references: [company_code], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, trx_date])
  @@unique([wms_id, trx_date], map: "uk_outgoing_headers_wms_id")
  @@index([company_code, trx_date(sort: Desc)], map: "idx_outgoing_headers_company")
  @@index([company_code, outgoing_date, customs_registration_date], map: "idx_outgoing_headers_company_date_range")
  @@index([customs_document_type, company_code], map: "idx_outgoing_headers_customs_doc")
  @@index([outgoing_date, company_code], map: "idx_outgoing_headers_date")
  @@index([owner, trx_date(sort: Desc)], map: "idx_outgoing_headers_owner")
  @@index([ppkek_number, company_code], map: "idx_outgoing_headers_ppkek")
  @@index([wms_id], map: "idx_outgoing_headers_wms_id")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model snapshot_recalc_queue {
  id             BigInt        @id @default(autoincrement())
  company_code   String        @db.VarChar(50)
  item_type_code String?       @db.VarChar(10)
  item_code      String?       @db.VarChar(50)
  recalc_date    DateTime      @db.Date
  status         recalc_status @default(PENDING)
  priority       Int           @default(0)
  reason         String?       @db.VarChar(500)
  queued_at      DateTime      @default(now()) @db.Timestamptz(6)
  started_at     DateTime?     @db.Timestamptz(6)
  completed_at   DateTime?     @db.Timestamptz(6)
  error_message  String?
  companies      companies     @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)

  @@index([company_code, recalc_date], map: "idx_recalc_queue_company_date")
  @@index([status, priority(sort: Desc), queued_at], map: "idx_recalc_queue_status")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model stock_daily_snapshot {
  id                 BigInt             @default(autoincrement())
  company_code       String             @db.VarChar(50)
  item_type_code     String             @db.VarChar(10)
  item_code          String             @db.VarChar(50)
  item_name          String             @db.VarChar(200)
  opening_balance    Decimal            @default(0) @db.Decimal(15, 3)
  closing_balance    Decimal            @default(0) @db.Decimal(15, 3)
  incoming_qty       Decimal            @default(0) @db.Decimal(15, 3)
  outgoing_qty       Decimal            @default(0) @db.Decimal(15, 3)
  production_qty     Decimal            @default(0) @db.Decimal(15, 3)
  material_usage_qty Decimal            @default(0) @db.Decimal(15, 3)
  adjustment_qty     Decimal            @default(0) @db.Decimal(15, 3)
  wip_balance_qty    Decimal?           @db.Decimal(15, 3)
  snapshot_date      DateTime           @db.Date
  calculated_at      DateTime           @default(now()) @db.Timestamptz(6)
  calculation_method calculation_method
  created_at         DateTime           @default(now()) @db.Timestamp(6)
  updated_at         DateTime           @default(now()) @db.Timestamp(6)
  companies          companies          @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)
  item_types         item_types         @relation(fields: [item_type_code], references: [item_type_code], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, snapshot_date])
  @@unique([company_code, item_type_code, item_code, snapshot_date], map: "uk_stock_snapshot")
  @@index([calculated_at], map: "idx_stock_snapshot_calculated")
  @@index([company_code, snapshot_date(sort: Desc)], map: "idx_stock_snapshot_company_date")
  @@index([company_code, item_code, snapshot_date(sort: Desc)], map: "idx_stock_snapshot_item")
  @@index([item_code, snapshot_date(sort: Desc)], map: "idx_stock_snapshot_item_date_range")
  @@index([company_code, item_type_code, snapshot_date(sort: Desc)], map: "idx_stock_snapshot_item_type")
  @@index([calculation_method, company_code], map: "idx_stock_snapshot_method")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model user_access_menus {
  id         String   @id @default(dbgenerated("(gen_random_uuid())::text"))
  user_id    String
  menu_id    String
  can_view   Boolean  @default(true)
  can_create Boolean  @default(false)
  can_edit   Boolean  @default(false)
  can_delete Boolean  @default(false)
  created_at DateTime @default(now()) @db.Timestamp(6)
  updated_at DateTime @default(now()) @db.Timestamp(6)
  menus      menus    @relation(fields: [menu_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users      users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, menu_id])
  @@index([menu_id], map: "idx_user_access_menus_menu_id")
  @@index([user_id], map: "idx_user_access_menus_user_id")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model users {
  id                String              @id @default(dbgenerated("(gen_random_uuid())::text"))
  username          String              @unique
  email             String              @unique
  password          String
  role              String              @default("USER")
  company_code      String?             @db.VarChar(50)
  created_at        DateTime            @default(now()) @db.Timestamp(6)
  updated_at        DateTime            @default(now()) @db.Timestamp(6)
  activity_logs     activity_logs[]
  user_access_menus user_access_menus[]
  companies         companies?          @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)

  @@index([email], map: "idx_users_email")
  @@index([username], map: "idx_users_username")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model wip_balance {
  id             BigInt     @default(autoincrement())
  wms_id         String     @db.VarChar(100)
  company_code   String     @db.VarChar(50)
  item_type_code String     @db.VarChar(10)
  item_code      String     @db.VarChar(50)
  item_name      String     @db.VarChar(200)
  snapshot_date  DateTime   @db.Date
  uom            String     @db.VarChar(20)
  qty            Decimal    @db.Decimal(15, 3)
  wms_timestamp  DateTime   @db.Timestamptz(6)
  received_at    DateTime   @default(now()) @db.Timestamptz(6)
  created_at     DateTime   @default(now()) @db.Timestamp(6)
  updated_at     DateTime   @default(now()) @db.Timestamp(6)
  companies      companies  @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)
  item_types     item_types @relation(fields: [item_type_code], references: [item_type_code], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, snapshot_date])
  @@unique([company_code, item_code, snapshot_date], map: "uk_wip_balance_item_date")
  @@unique([wms_id, snapshot_date], map: "uk_wip_balance_wms_id")
  @@index([company_code, snapshot_date(sort: Desc)], map: "idx_wip_balance_company")
  @@index([company_code, item_code, snapshot_date(sort: Desc)], map: "idx_wip_balance_item")
  @@index([wms_id], map: "idx_wip_balance_wms_id")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model work_order_fg_production {
  id                   BigInt     @default(autoincrement())
  production_header_id BigInt
  production_detail_id BigInt
  production_wms_id    String     @db.VarChar(100)
  work_order_number    String     @db.VarChar(50)
  company_code         String     @db.VarChar(50)
  item_type_code       String     @db.VarChar(10)
  item_code            String     @db.VarChar(50)
  qty_produced         Decimal    @db.Decimal(15, 3)
  trx_date             DateTime   @db.Date
  created_at           DateTime   @default(now()) @db.Timestamp(6)
  companies            companies  @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)
  item_types           item_types @relation(fields: [item_type_code], references: [item_type_code], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, trx_date])
  @@index([company_code, item_code, trx_date(sort: Desc)], map: "idx_work_order_fg_production_item")
  @@index([company_code, item_type_code, trx_date(sort: Desc)], map: "idx_work_order_fg_production_item_type")
  @@index([production_wms_id, company_code], map: "idx_work_order_fg_production_production")
  @@index([work_order_number, company_code], map: "idx_work_order_fg_production_wo")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model work_order_material_consumption {
  id                       BigInt    @default(autoincrement())
  material_usage_header_id BigInt
  material_usage_detail_id BigInt
  material_usage_wms_id    String    @db.VarChar(100)
  work_order_number        String    @db.VarChar(50)
  company_code             String    @db.VarChar(50)
  item_code                String    @db.VarChar(50)
  ppkek_number             String?   @db.VarChar(50)
  qty_consumed             Decimal   @db.Decimal(15, 3)
  trx_date                 DateTime  @db.Date
  created_at               DateTime  @default(now()) @db.Timestamp(6)
  companies                companies @relation(fields: [company_code], references: [company_code], onDelete: NoAction, onUpdate: NoAction)

  @@id([id, trx_date])
  @@index([company_code, item_code, trx_date(sort: Desc)], map: "idx_work_order_material_consumption_item")
  @@index([material_usage_wms_id, company_code], map: "idx_work_order_material_consumption_material")
  @@index([work_order_number, company_code], map: "idx_work_order_material_consumption_wo")
}

enum ActivityStatus {
  SUCCESS
  FAILED
  WARNING
}

enum AdjustmentType {
  GAIN
  LOSS
}

enum CalculationMethod {
  TRANSACTION
  WIP_SNAPSHOT
}

enum CurrencyCode {
  USD
  IDR
  CNY
  EUR
  JPY
}

enum CustomsDocumentTypeIncoming {
  BC23
  BC27
  BC40
}

enum CustomsDocumentTypeOutgoing {
  BC30
  BC25
  BC27
  BC41
}

enum ItemTypeCode {
  ROH
  HALB
  FERT
  HIBE_M
  HIBE_E
  HIBE_T
  HIBE
  SCRAP
  DIEN
}

enum JobStatus {
  PENDING
  RUNNING
  COMPLETED
  FAILED
  CANCELLED
}

enum JobType {
  HOURLY_BATCH
  EOD_SNAPSHOT
  RECALC_QUEUE
  MANUAL_TRIGGER
}

enum RecalcStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
}

enum UserRole {
  ADMIN
  USER
  VIEWER
}

/// This enum is commented in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
enum adjustment_type {
  GAIN
  LOSS
}

/// This enum is commented in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
enum calculation_method {
  TRANSACTION
  WIP_SNAPSHOT
}

/// This enum is commented in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
enum currency_code {
  USD
  IDR
  CNY
  EUR
  JPY
}

/// This enum is commented in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
enum customs_document_type_incoming {
  BC23
  BC27
  BC40
}

/// This enum is commented in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
enum customs_document_type_outgoing {
  BC30
  BC25
  BC27
  BC41
}

/// This enum is commented in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
enum recalc_status {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
}
